# ç¬¬ä¸€ç«  é¢„å¤‡çŸ¥è¯†

## ä¸€ã€PythonåŸºç¡€

### 1ã€åˆ—è¡¨æ¨å¯¼å¼ä¸æ¡ä»¶èµ‹å€¼

``` python
L =[]

def my_func(x):
    return 2*x

for i in range(10):
    L.append(my_func(i))
    
L
```

å®é™…ä¸Šå¯ä»¥åˆ©ç”¨åˆ—è¡¨æ¨å¯¼å¼è¿›è¡Œå†™æ³•ä¸Šçš„ç®€åŒ–.
åˆ—è¡¨æ¨å¯¼å¼:`[expr for val in collection if condition]`
ç­‰åŒäºforå¾ªç¯ï¼š

```python
result = []
for val in collection:
    if condition:
        result.append(expr)
```

``` python
[my_func(i) for i in range(10)]
```

#### åµŒå¥—æ¨å¯¼å¼(è¿™éƒ¨åˆ†å†…å®¹æ¥è‡ªåˆ©ç”¨pythonè¿›è¡Œæ•°æ®åˆ†æç¬¬4ç« )

æ¯”å¦‚æˆ‘ä»¬æƒ³ç­›é€‰å‡ºåå­—ä¸­eå­—æ¯å¤šäº2çš„åå­—ï¼Œä½¿ç”¨åµŒå¥—å¾ªç¯ä½¿ä»£ç å˜å¾—ç®€æ´

``` python
all_data = [['John', 'Emily', 'Michael', 'Mary', 'Steven'],
            ['Maria', 'Juan', 'Javier', 'Natalia', 'Pilar']]
result = [name for names in all_data for name in names if name.count('e') >=2]

result
# ['Steven']
```

å¦ä¸€ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å°†ä¸€ä¸ªæ•´æ•°å…ƒç»„çš„åˆ—è¡¨æ‰å¹³åŒ–

``` python
some_tuples = [(1,2,3),(4,5,6),(7,8,9)]

# ä½¿ç”¨forå¾ªç¯
flattened = []

for tup in some_tuples:
    for x in tup:
        flattened.append(x)
        
#forè¡¨è¾¾å¼çš„é¡ºåºä¸åµŒå¥—å¾ªç¯çš„é¡ºåºä¸€æ ·
flattened = [x for tup in some_tuples for x in tup]
flattened
# [1, 2, 3, 4, 5, 6, 7, 8, 9]

#åˆ—è¡¨æ¨å¯¼å¼çš„åˆ—è¡¨æ¨å¯¼å¼
[[x for x in tup] for tup in some_tuples]
# [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
```

é™¤äº†åˆ—è¡¨æ¨å¯¼å¼ï¼Œå¦ä¸€ä¸ªå®ç”¨çš„è¯­æ³•ç³–æ˜¯å¸¦æœ‰ifçš„æ¡ä»¶èµ‹å€¼ï¼Œå…¶å½¢å¼ä¸º`value = a if condition else b`

### 2ã€åŒ¿åå‡½æ•°ä¸mapæ–¹æ³•

pythonæ”¯æŒä¸€ç§è¢«ç§°ä¸ºåŒ¿åçš„å‡½æ•°ï¼Œå®ƒä»…æœ‰å•æ¡è¯­å¥ç»„æˆï¼Œè¯¥è¯­å¥çš„ç»“æœå°±æ˜¯è¿”å›å€¼ï¼Œå®ƒé€šè¿‡lambdaå…³é”®å­—å®šä¹‰ï¼Œè¿™æ ·çœå»äº†è®¸å¤šä»£ç 

``` python
[(lambda x: 2*x)(i) for i in range(5)]
# [0, 2, 4, 6, 8]
```

åœ¨ä¸Šè¿°çš„è¿™ç§åˆ—è¡¨æ¨å¯¼å¼çš„åŒ¿åå‡½æ•°æ˜ å°„ï¼ŒPythonä¸­æä¾›äº†mapå‡½æ•°æ¥å®Œæˆï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªmapå¯¹è±¡ï¼Œéœ€è¦é€šè¿‡listè½¬ä¸ºåˆ—è¡¨ï¼š

``` python
list(map(lambda x: 2*x, range(5)))
# [0, 2, 4, 6, 8]
```

### 3ã€zipå¯¹è±¡ä¸enumerateæ–¹æ³•

zipå‡½æ•°èƒ½æŠŠå¤šä¸ªåˆ—è¡¨ã€å…ƒç»„æˆ–å…¶å®ƒåºåˆ—å¯¹ç»„åˆæˆä¸€ä¸ªå…ƒç»„åˆ—è¡¨ï¼š

``` python
seq1 = ['foo', 'bar', 'baz']

seq2 = ['one', 'two', 'three']

zipped = zip(seq1,seq2)

list(zipped)
# [('foo', 'one'), ('bar', 'two'), ('baz', 'three')]
```

zipå¯ä»¥å¤„ç†ä»»æ„å¤šçš„åºåˆ—ï¼Œå…ƒç´ çš„ä¸ªæ•°å–å†³äºæœ€çŸ­çš„åºåˆ—

zipçš„å¸¸è§ç”¨æ³•ä¹‹ä¸€æ˜¯åŒæ—¶è¿­ä»£å¤šä¸ªåºåˆ—ï¼Œå¯èƒ½ç»“åˆ`enumerate`ä½¿ç”¨

```python
for i, (a, b) in enumerate(zip(seq1, seq2)):
     print('{0}: {1}, {2}'.format(i, a, b))
# 0: foo, one
# 1: bar, two
# 2: baz, three
```

ç»™å‡ºä¸€ä¸ªè¢«å‹ç¼©åºåˆ—ï¼Œzip (*)å¯ä»¥è¢«ç”¨æ¥è§£å‹åºåˆ—ï¼Œä¹Ÿå¯ä»¥å•ç‹¬æå‡ºæŸä¸€åˆ—è¡¨orå…ƒç»„

``` python
pitchers = [('Nolan', 'Ryan'), ('Roger', 'Clemens'),
             ('Schilling', 'Curt')]

first_names, last_names = zip(*pitchers)

first_names
#('Nolan', 'Roger', 'Schilling')

last_names
# ('Ryan', 'Clemens', 'Curt')
```



## äºŒã€NumpyåŸºç¡€

#### 1ã€ä¸€äº›ç‰¹æ®Šæ•°ç»„

ç­‰å·®åºåˆ—ï¼š`np.linspace`,`np.arange`

``` python
np.linspace(1,5,11) #èµ·å§‹ã€ç»ˆæ­¢ï¼ˆåŒ…å«ï¼‰ã€æ ·æœ¬ä¸ªæ•°
# array([1. , 1.4, 1.8, 2.2, 2.6, 3. , 3.4, 3.8, 4.2, 4.6, 5. ])
np.arange(1,5,0.4) #èµ·å§‹ã€ç»ˆæ­¢ï¼ˆä¸åŒ…å«ï¼‰ã€æ­¥é•¿
# array([1. , 1.4, 1.8, 2.2, 2.6, 3. , 3.4, 3.8, 4.2, 4.6])
```

#### 2ã€éšæœºçŸ©é˜µ

choiceå¯ä»¥ä»ç»™å®šçš„åˆ—è¡¨ä¸­ï¼Œä»¥ä¸€å®šæ¦‚ç‡å’Œæ–¹å¼æŠ½å–ç»“æœï¼Œå½“ä¸æŒ‡å®šæ¦‚ç‡æ—¶ä¸ºå‡åŒ€é‡‡æ ·ï¼Œé»˜è®¤æŠ½å–æ–¹å¼ä¸ºæœ‰æ”¾å›æŠ½å–

``` python
my_list = ['a', 'b', 'c', 'd']

np.random.choice(my_list, 2, replace=True, p=[0.1, 0.7, 0.1, 0.1])
# array(['b', 'b'], dtype='<U1')

np.random.choice(my_list,(3,3))
# array([['a', 'b', 'b'],
#       ['d', 'c', 'd'],
#      ['b', 'b', 'c']], dtype='<U1')
```

å½“å°†æŠ½å–æ–¹å¼æ”¹ä¸ºæ— æ”¾å›æ—¶ï¼Œè¿”å›çš„å…ƒç´ ä¸ªæ•°ä¸åŸåˆ—è¡¨ç›¸åŒæ—¶ï¼Œç­‰ä»·äºä½¿ç”¨`permutation`å‡½æ•°ï¼Œå³æ‰“æ•£åŸåˆ—è¡¨

#### 3ã€å¸¸ç”¨å‡½æ•°

`nonzero` `argmax` `argmin`

è¿™ä¸‰ä¸ªå‡½æ•°è¿”å›çš„éƒ½æ˜¯ç´¢å¼•

``` python
np.nonzero(a)  # è¿”å›çš„æ˜¯éé›¶æ•°çš„ç´¢å¼•
#  a = np.array([-2,-5,0,1,3,-1])

a.argmax() #è¿”å›æœ€å¤§æ•°çš„ç´¢å¼•
# 4

a.argmin() #è¿”å›æœ€å°æ•°çš„ç´¢å¼•
# 1
```

#### 4ã€å‘é‡ä¸çŸ©é˜µçš„è®¡ç®—

**å‘é‡å†…ç§¯ï¼š**
$$
\rm \mathbf{a}\cdot\mathbf{b} = \sum_ia_ib_i
$$

``` python
a = np.array([1,2,3])
b = np.array([2,3,4])

np.dot(a,b)
# 20
```

**å‘é‡èŒƒæ•°å’ŒçŸ©é˜µèŒƒæ•°**

` numpy.linalg.norm(x, ord=None, axis=None, keepdims=False)`

åœ¨çŸ©é˜µèŒƒæ•°çš„è®¡ç®—ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯ordå‚æ•°ï¼Œä¹‹å‰numpyæœ‰å…·ä½“å†…å®¹

``` python
martix_target = np.arange(4).reshape(-1,2)
martix_target
# array([[0, 1],
#        [2, 3]])
np.linalg.norm(martix_target, 'fro')
# 3.7416573867739413
np.linalg.norm(martix_target, np.inf)
# 5.0
np.linalg.norm(martix_target, 2)
# 3.702459173643833
```

``` python
vector_target =  np.arange(4)
vector_target
# array([0, 1, 2, 3])
np.linalg.norm(vector_target, np.inf)
# 3.0
np.linalg.norm(vector_target, 2)
# 3.7416573867739413
np.linalg.norm(vector_target, 3)
# 3.3019272488946263
```

**çŸ©é˜µä¹˜æ³•**
$$
\rm [\mathbf{A}_{m\times p}\mathbf{B}_{p\times n}]_{ij} = \sum_{k=1}^p\mathbf{A}_{ik}\mathbf{B}_{kj}
$$

``` python
a = np.arange(4).reshape(-1,2)
# array([[0, 1],
#        [2, 3]])
    
b = np.arange(-2,2).reshape(2,2)
# array([[-2, -1],
#        [ 0,  1]])

a@b
# array([[ 0,  1],
#       [-4,  1]])
```

## ä¸‰ã€ç»ƒä¹ 

### Ex1ï¼šåˆ©ç”¨åˆ—è¡¨æ¨å¯¼å¼å†™çŸ©é˜µä¹˜æ³•

ä¸€èˆ¬çš„çŸ©é˜µä¹˜æ³•æ ¹æ®å…¬å¼ï¼Œå¯ä»¥ç”±ä¸‰é‡å¾ªç¯å†™å‡ºï¼Œè¯·å°†å…¶æ”¹å†™ä¸ºåˆ—è¡¨æ¨å¯¼å¼çš„å½¢å¼ã€‚

``` python
M1 = np.random.rand(2,3)
M2 = np.random.rand(3,4)
res = np.empty((M1.shape[0],M2.shape[1]))
for i in range(M1.shape[0]):
    for j in range(M2.shape[1]):
        item = 0
        for k in range(M1.shape[1]):
            item += M1[i][k] * M2[k][j]
        res[i][j] = item
((M1@M2 - res) < 1e-15).all() # æ’é™¤æ•°å€¼è¯¯å·®
```

å‚è€ƒç­”æ¡ˆï¼š

``` python
res = [[sum([M1[i][k] * M2[k][j] for k in range(M1.shape[1])]) for j in range(M2.shape[1])] for i in range(M1.shape[0])]
```

### Ex2ï¼šæ›´æ–°çŸ©é˜µ

è®¾çŸ©é˜µ A<sub>mXn</sub> ï¼Œç°åœ¨å¯¹  A<sub>mXn</sub>ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œæ›´æ–°ç”ŸæˆçŸ©é˜µ  B<sub>mXn</sub> ï¼Œæ›´æ–°æ–¹æ³•æ˜¯ 
$$
B_{ij}=A_{ij}\sum_{k=1}^n\frac{1}{A_{ik}}
$$
ä¾‹å¦‚ä¸‹é¢çš„çŸ©é˜µä¸º  A<sub>mXn</sub> ï¼Œåˆ™ 
$$
 B_{2,2}=5\times(\frac{1}{4}+\frac{1}{5}+\frac{1}{6})=\frac{37}{12}
$$
è¯·åˆ©ç”¨ `Numpy` é«˜æ•ˆå®ç°ã€‚
$$
\begin{split}A=\left[ \begin{matrix} 1 & 2 &3\\4&5&6\\7&8&9 \end{matrix} \right]\end{split}
$$

``` python
B=A*np.sum(1/A,axis=1).reshape(3,1)
B
# array([[1.83333333, 3.66666667, 5.5       ],
#        [2.46666667, 3.08333333, 3.7       ],
#        [2.65277778, 3.03174603, 3.41071429]])
```

### Ex3ï¼šå¡æ–¹ç»Ÿè®¡é‡

è®¾çŸ©é˜µA<sub>mXn</sub>ï¼Œè®°
$$
B_{ij} = \frac{(\sum_{i=1}^mA_{ij})\times (\sum_{j=1}^nA_{ij})}{\sum_{i=1}^m\sum_{i=1}^nA_{ij}}
$$
å®šä¹‰å¡æ–¹å€¼å¦‚ä¸‹ï¼š
$$
\chi^2 = \sum_{i=1}^m\sum_{j=1}^n\frac{(A_{ij}-B_{ij})^2}{B_{ij}}
$$
è¯·åˆ©ç”¨`Numpy`å¯¹ç»™å®šçš„çŸ©é˜µğ´è®¡ç®—ğœ’2

``` python
np.random.seed(0)
A = np.random.randint(10, 20, (8, 5))
```

``` python

```

### Ex4ï¼šæ”¹è¿›çŸ©é˜µè®¡ç®—çš„æ€§èƒ½

è®¾ğ‘ä¸ºğ‘šÃ—ğ‘›çš„çŸ©é˜µï¼Œğµå’Œğ‘ˆåˆ†åˆ«æ˜¯ğ‘šÃ—ğ‘å’Œğ‘Ã—ğ‘›çš„çŸ©é˜µï¼Œğµğ‘–ä¸ºğµçš„ç¬¬ğ‘–è¡Œï¼Œğ‘ˆğ‘—ä¸ºğ‘ˆçš„ç¬¬ğ‘—åˆ—ï¼Œä¸‹é¢å®šä¹‰ï¼Œ
$$
\displaystyle R=\sum_{i=1}^m\sum_{j=1}^n\|B_i-U_j\|_2^2Z_{ij}$ï¼Œå…¶ä¸­\|\mathbf{a}\|_2^2è¡¨ç¤ºå‘é‡açš„åˆ†é‡å¹³æ–¹å’Œ\sum_i a_i^2ã€‚
$$
ç°æœ‰æŸäººæ ¹æ®å¦‚ä¸‹ç»™å®šçš„æ ·ä¾‹æ•°æ®è®¡ç®—ğ‘…çš„å€¼ï¼Œè¯·å……åˆ†åˆ©ç”¨`Numpy`ä¸­çš„å‡½æ•°ï¼ŒåŸºäºæ­¤é—®é¢˜æ”¹è¿›è¿™æ®µä»£ç çš„æ€§èƒ½ã€‚

``` python
np.random.seed(0)
m, n, p = 100, 80, 50
B = np.random.randint(0, 2, (m, p))
U = np.random.randint(0, 2, (p, n))
Z = np.random.randint(0, 2, (m, n))
def solution(B=B, U=U, Z=Z):
    L_res = []
    for i in range(m):
        for j in range(n):
            norm_value = ((B[i]-U[:,j])**2).sum()
            L_res.append(norm_value*Z[i][j])
    return sum(L_res)
solution(B, U, Z)
```

å› ä¸ºå‡ ä¹å·®ä¸å¤šå®Œå…¨æ²¡çœ‹æ˜ç™½ï¼Œæš‚æ—¶è·³è¿‡å¥½äº†

markä¸€ä¸‹ç­”æ¡ˆ

``` python
(((B**2).sum(1).reshape(-1,1) + (U**2).sum(0) - 2*B@U)*Z).sum()
#100566
```

### Ex5ï¼šè¿ç»­æ•´æ•°çš„æœ€å¤§é•¿åº¦

è¾“å…¥ä¸€ä¸ªæ•´æ•°çš„`Numpy`æ•°ç»„ï¼Œè¿”å›å…¶ä¸­é€’å¢è¿ç»­æ•´æ•°å­æ•°ç»„çš„æœ€å¤§é•¿åº¦ï¼Œæ­£å‘æ˜¯æŒ‡é€’å¢æ–¹å‘ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥[1,2,5,6,7]ï¼Œ[5,6,7]ä¸ºå…·æœ‰æœ€å¤§é•¿åº¦çš„è¿ç»­æ•´æ•°å­æ•°ç»„ï¼Œå› æ­¤è¾“å‡º3ï¼›è¾“å…¥[3,2,1,2,3,4,6]ï¼Œ[1,2,3,4]ä¸ºå…·æœ‰æœ€å¤§é•¿åº¦çš„è¿ç»­æ•´æ•°å­æ•°ç»„ï¼Œå› æ­¤è¾“å‡º4ã€‚è¯·å……åˆ†åˆ©ç”¨`Numpy`çš„å†…ç½®å‡½æ•°å®Œæˆã€‚ï¼ˆæç¤ºï¼šè€ƒè™‘ä½¿ç”¨`nonzero, diff`å‡½æ•°ï¼‰

``` python
f = lambda x:np.diff(np.nonzero(np.r_[1,np.diff(x)!=1,1])).max()

f([1,2,5,6,7])
3

f([3,2,1,2,3,4,6])
4
```

